(function(){"use strict";var __webpack_modules__={259:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{G:function(){return DOMutils}});var DOMutils={create:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.createElement(t);return e&&r.classList.add(e),r},addHTML:function(t,e){t.innerHTML=e},getText:function(t){return t.textContent.trim()},clear:function(t){this.addHTML(t,"")},getCoords:function(t){return t.getBoundingClientRect()},addClass:function(t,e){t.classList.add(e)},removeClass:function(t,e){t.classList.remove(e)},getCellId:function(t){var e=t.dataset.id.split(":");return{row:+e[0],col:+e[1]}},changeText:function(t,e){t.textContent=e},getStyles:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return t.reduce((function(t,r){return t[r]=e.style[r],t}),{})},attr:function(t,e,r){r&&t.setAttribute(e,r),t.getAttribute(e)},parseCell:function parseCell(value){return value.startsWith("=")?eval(value.slice(1)):value}}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=function(t,e){for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={};!function(){var t=__webpack_require__(259);function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var r,n,o;return r=t,o=[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"param",get:function(){return t.path.split("/")[1]}},{key:"navigate",value:function(t){window.location.hash=t}}],(n=null)&&e(r.prototype,n),o&&e(r,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function e(t,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("Selector is not provided in Router");this.$placeholder=document.querySelector(t),this.routes=r,this.changePageHandler=this.changePageHandler.bind(this),this.page=null,this.init()}var o,i,c;return o=e,i=[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:function(){this.page&&this.page.destroy(),t.G.clear(this.$placeholder);var e=r.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new e(r.param);var n=this.page.getRoot();this.$placeholder.append(n),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}],i&&n(o.prototype,i),c&&n(o,c),Object.defineProperty(o,"prototype",{writable:!1}),e}();function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e}var e,r,n;return e=t,(r=[{key:"getRoot",value:function(){throw new Error("Method should be implemented")}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}])&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function l(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function s(t,e){var r;return function(){for(var n=this,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];var a=function(){clearTimeout(r),t.apply(n,i)};clearTimeout(r),r=setTimeout(a,e)}}function f(t){t.preventDefault()}function p(t){var e=y(t),r=new Date(e),n=u(t),o=t.split(":")[1];return' <li class="dashboard__record">\n              <a href="#excel/'.concat(o,'">').concat(n.title,"</a>\n              <strong>\n              ").concat(r.toLocaleDateString()," \n              &ensp;\n              ").concat(r.toLocaleTimeString(),"\n              </strong>\n            </li>")}function y(t){return+t.split(":")[1]}function h(t){return"excel:".concat(t)}function b(){var t=function(){for(var t=[],e=0;e<localStorage.length;e++){var r=localStorage.key(e);r.includes("excel")&&t.push(r)}return t}();return t.length?'<div class="dashboard__list-header">\n            <span>Название</span>\n            <span>Дата открытия</span>\n          </div>\n          <ul class="dashboard__list">\n          '.concat(t.map(y).sort((function(t,e){return e-t})).map(h).map(p).join(""),"\n          </ul>"):"<p>Нет созданных таблиц</p>"}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=j(t);if(e){var o=j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var _=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(c,e);var r,n,o,i=w(c);function c(){return d(this,c),i.apply(this,arguments)}return r=c,(n=[{key:"getRoot",value:function(){var e=Date.now().toString(),r=t.G.create("div","dashboard");return t.G.addHTML(r,'\n        <div class="dashboard__header">\n          <h1>Excel Dashboard</h1>\n        </div>\n        <div class="dashboard__new">\n          <div class="dashboard__view">\n            <a href="#excel/'.concat(e,'" class="dashboard__create">\n              Новая<br />\n              Таблица\n            </a>\n          </div>\n        </div>\n        <div class="dashboard__table dashboard__view">\n          ').concat(b(),"\n        </div>")),r}}])&&m(r.prototype,n),o&&m(r,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(c);function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var T=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(this,t),this.initalState=r,this.rootReducer=e,this.listeners=new Set,this.state=this.rootReducer(S({},r),{type:"__INIT__"})}var e,r,n;return e=t,(r=[{key:"subscribe",value:function(t){this.listeners.add(t)}},{key:"dispatch",value:function(t){var e=this;this.state=this.rootReducer(this.state,t),this.listeners.forEach((function(t){return t(e.state)}))}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"unsubscribe",value:function(){this.listeners.clear()}}])&&x(e.prototype,r),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var C=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners={}}var e,r,n;return e=t,r=[{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(0==this.listeners[t].size)throw new Error("listeners is empty, please subscribe on event");this.listeners[t].forEach((function(t){t.apply(void 0,r)}))}},{key:"subscribe",value:function(t,e){this.listeners[t]=this.listeners[t]||new Set,this.listeners[t].add(e)}},{key:"unsubscribe",value:function(t,e){this.listeners[t].has(e)&&this.listeners[t].delete(e)}}],r&&R(e.prototype,r),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var L=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=null,this.components=null,this.prevState={}}var e,r,n;return e=t,r=[{key:"setComponents",value:function(t){this.components=t}},{key:"subComponents",value:function(){var t=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(e){Object.keys(e).forEach((function(r){var n,o;n=t.prevState[r],o=e[r],("object"===a(n)&&"object"===a(o)?JSON.stringify(n)===JSON.stringify(o):n===o)||t.components.forEach((function(t){if(t.isWatching(r)){var n=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},r,e[r]);t.storeChanged(n)}}))})),t.prevState=t.store.getState()}))}},{key:"unsubFromStore",value:function(){this.store.unsubscribe()}}],r&&D(e.prototype,r),n&&D(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var G=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.components=t.components||[],this.emitter=new C,this.store=t.store,this.subscriber=new L(this.store)}var r,n,o;return r=e,(n=[{key:"initComponent",value:function(e){var r={emitter:this.emitter,store:this.store},n=t.G.create("div",e.className),o=new e(n,r);return t.G.addHTML(n,o.toHTML()),o.prepare(),this.$excel.append(n),o}},{key:"createExcel",value:function(){var r=this;this.$excel=t.G.create("div",e.className),this.components=this.components.map((function(t){return r.initComponent(t)})),this.subscriber.setComponents(this.components)}},{key:"getRoot",value:function(){return this.createExcel(),this.$excel}},{key:"init",value:function(){document.addEventListener("contextmenu",f),this.subscriber.subComponents(),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubFromStore(),this.components.forEach((function(t){return t.destroy()})),document.removeEventListener("contextmenu",f)}}])&&A(r.prototype,n),o&&A(r,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}!function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(G,"className","excel");var N=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(H(this,t),!e)throw new Error("no $root provided for DomListener");this.$root=e,this.listeners=r}var e,r,n;return e=t,(r=[{key:"initDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=M(e);if(!t[r])throw new Error("The method ".concat(r," is not create in ").concat(t.name||""," component"));t[r]=t[r].bind(t),t.$root.addEventListener(e,t[r])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r=M(e);t.$root.removeEventListener(e,t[r])}))}}])&&I(e.prototype,r),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function M(t){return"on".concat("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function z(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=U(t);if(e){var o=U(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Y(this,r)}}function Y(t,e){if(e&&("object"===$(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},U(t)}var K=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(i,t);var e,r,n,o=F(i);function i(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return q(this,i),(e=o.call(this,t,r.listeners)).name=r.name,e.emitter=r.emitter,e.subs={},e.store=r.store,e.subscribe=r.subscribe||"",e}return e=i,r=[{key:"toHTML",value:function(){return""}},{key:"prepare",value:function(){}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsubscribeFromEvents()}},{key:"emitEvent",value:function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[t].concat(n))}},{key:"storeChanged",value:function(){}},{key:"subscribeOnEvent",value:function(t,e){this.subs[t]=e,this.emitter.subscribe(t,e)}},{key:"unsubscribeFromEvents",value:function(){for(var t=0,e=Object.entries(this.subs);t<e.length;t++){var r=z(e[t],2),n=r[0],o=r[1];this.emitter.unsubscribe(n,o)}}},{key:"dispatch",value:function(t){this.store.dispatch(t)}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}}],r&&W(e.prototype,r),n&&W(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(N),X={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal"},Z="Новая таблица",Q="TABLE_RESIZE",V="CHANGE_TEXT",tt="APPLY_STYLE",et="CHANGE_STYLES",rt="CHANGE_TITLE";function nt(t){return{type:Q,data:t}}function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function at(){return at="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ut(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},at.apply(this,arguments)}function ut(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pt(t)););return t}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}function st(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pt(t);if(e){var o=pt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ft(this,r)}}function ft(t,e){if(e&&("object"===ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}function yt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(c,t);var e,n,o,i=st(c);function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?it(Object(r),!0).forEach((function(e){yt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Header",listeners:["input","click"]},e))}return e=c,(n=[{key:"prepare",value:function(){this.onInput=s(this.onInput,100)}},{key:"init",value:function(){at(pt(c.prototype),"init",this).call(this)}},{key:"toHTML",value:function(){var t=this.store.getState().title||Z;return'<input type="text" class="input" value="'.concat(t,'" />\n          <div class="buttons">\n            <div class="btn" data-btn="remove">\n              <span class="material-icons"> delete </span>\n            </div>\n            <div class="btn" data-btn="exit">\n              <span class="material-icons"> exit_to_app </span>\n            </div>\n          </div>')}},{key:"onInput",value:function(t){var e,r=t.target;this.dispatch((e=r.value,{type:rt,data:e}))}},{key:"onClick",value:function(t){var e,n=t.target;if(n.closest(".btn")){var o=n.closest(".btn");"remove"===o.dataset.btn?confirm("Вы действительно хотите удалить таблицу?")&&(e="excel:"+r.param,localStorage.removeItem(e),r.navigate("")):"exit"===o.dataset.btn&&r.navigate("")}}}])&&ct(e.prototype,n),o&&ct(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(K);function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function vt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function dt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(r),!0).forEach((function(e){mt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function mt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Pt(t);if(e){var o=Pt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _t(this,r)}}function _t(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pt(t){return Pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pt(t)}yt(ht,"className","excel__header");var St=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(i,t);var e,r,n,o=jt(i);function i(){gt(this,i);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.call.apply(o,[this].concat(e))}return e=i,r=[{key:"getTemplate",value:function(){return JSON.stringify(this.state,null,2)}},{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=dt({},t)}},{key:"setState",value:function(t){this.state=dt(dt({},this.state),t),this.$root.innerHTML=this.getTemplate()}}],r&&wt(e.prototype,r),n&&wt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(K);function Et(t){var e=JSON.stringify(t.value),r='data-type="button"\n                data-value=\''.concat(e,"'");return'<div class="btn '.concat(t.active?"active":"",'" ').concat(r,'>\n            <span class="material-icons" ').concat(r,"> ").concat(t.icon," </span>\n          </div>")}function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function xt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rt(t,e){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Rt(t,e)}function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lt(t);if(e){var o=Lt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Dt(this,r)}}function Dt(t,e){if(e&&("object"===kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Lt(t){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lt(t)}function At(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rt(t,e)}(i,t);var e,r,n,o=Ct(i);function i(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),r=o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(r),!0).forEach((function(e){At(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]},e)),r.initState(r.store.getState().currentStyles),r}return e=i,r=[{key:"getTemplate",value:function(){return[{icon:"format_align_left",active:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",active:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underlined",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(Et).join("");var t}},{key:"toHTML",value:function(){return this.getTemplate()}},{key:"storeChanged",value:function(t){var e=t.currentStyles;this.setState(e)}},{key:"onClick",value:function(t){var e=t.target;if("button"===e.dataset.type){var r=JSON.parse(e.dataset.value);this.emitEvent("toolbar:applyStyle",r)}}}],r&&Tt(e.prototype,r),n&&Tt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(St);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function It(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mt(t,e){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mt(t,e)}function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Bt(t);if(e){var o=Bt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return zt(this,r)}}function zt(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}function qt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}At(Gt,"className","excel__toolbar");var Wt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mt(t,e)}(c,e);var r,n,o,i=$t(c);function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?It(Object(r),!0).forEach((function(e){qt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Formula",listeners:["input","keydown"],subscribe:["currentText"]},e))}return r=c,(n=[{key:"prepare",value:function(){this.$input=this.$root.querySelector(".input"),this.subscribeEvents()}},{key:"storeChanged",value:function(e){var r=e.currentText;t.G.changeText(this.$input,r)}},{key:"subscribeEvents",value:function(){var e=this;this.subscribeOnEvent("table:select",(function(r){t.G.changeText(e.$input,r)}))}},{key:"toHTML",value:function(){return'\n          <div class="info">fx</div>\n          <div class="input" contenteditable="true" spellcheck="false"></div>'}},{key:"onInput",value:function(){var e=t.G.getText(this.$input);this.emitEvent("formula:input",e)}},{key:"onKeydown",value:function(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.emitEvent("formula:done"))}}])&&Nt(r.prototype,n),o&&Nt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(K);function Jt(t,e){if(t>e){var r=[t,e];e=r[0],t=r[1]}return new Array(e-t+1).fill("").map((function(e,r){return t+r}))}qt(Wt,"className","excel__formula");var Ft=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);function Yt(e,r){return new Promise((function(n){"col"===r.dataset.resize?n(function(e,r){return new Promise((function(n){var o,i=e.closest('[data-type="resizeble"]'),c=t.G.getCoords(i),a=i.dataset.col,u=r.querySelectorAll("[data-col='".concat(a,"']"));e.style.height=Ft+"px",e.style.zIndex=1e3;var l=function(t){var r=t.clientX-c.left-i.clientWidth;o=c.width+r,e.style.left=o-e.clientWidth+"px"};document.addEventListener("mousemove",l),document.onmouseup=function(){o<40&&(o=40),n({value:o,id:a,type:"col"}),e.style.left=o-e.offsetWidth+"px",e.style.zIndex=100,e.style.height=i.offsetHeight+"px",u.forEach((function(t){return t.style.width=o+"px"})),document.removeEventListener("mousemove",l),document.onmouseup=null}}))}(r,e)):n(function(e){return new Promise((function(r){var n,o=e.closest('[data-type="resizeble"]'),i=t.G.getCoords(o),c=o.dataset.id;e.style.width=o.offsetWidth+"px",e.style.zIndex=1e3;var a=function(t){var r=t.clientY-i.top-o.clientHeight;n=i.height+r,e.style.top=n-e.clientHeight+"px"};document.addEventListener("mousemove",a),document.onmouseup=function(){n<24&&(n=24),r({value:n,id:c,type:"row"}),e.style.top=n-e.offsetHeight+"px",e.style.zIndex=100,e.style.width="40px",o.style.height=n+"px",document.removeEventListener("mousemove",a),document.onmouseup=null}}))}(r))}))}function Ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Kt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(r),!0).forEach((function(e){Xt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ut(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Xt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Zt=65,Qt=90;function Vt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return t[e]?t[e]+"px":"120px"}function te(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return t[e]?t[e]+"px":"24px"}function ee(t){return function(e,r){return{col:e,index:r,width:Vt(t.colState,r)}}}function re(t,e){return String.fromCharCode(Zt+e)}function ne(e,r){return function(n,o){var i="".concat(e,":").concat(o),c=Vt(r.colState,o),a=t.G.parseCell(function(t,e){return t[e]||""}(r.dataState,i)),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(l(e),": ").concat(t[e])})).join(";")}(Kt(Kt({},X),r.stylesState[i]));return'<div class="cell" \n            contenteditable="" \n            data-col=\''.concat(o,"' \n            data-id='").concat(i,"'\n            data-value=\"").concat(a,'"\n            style="').concat(u,";width:").concat(c,'">').concat(a,"</div>")}}function oe(t){var e=t.col,r=t.index,n=t.width;return'<div class="column" data-type="resizeble" style="width:'.concat(n,"\" \n   data-col='").concat(r,"'>").concat(e,' \n          <div class="col-resize" data-resize="col"></div>\n  </div>')}function ie(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=te(r.rowState,t),o=t?'<div class="row-resize" data-resize="row"></div>':"";return'<div class="row"\n          style="height:'.concat(n,' \n          "data-id="').concat(t,'"  data-type="').concat(t?"resizeble":"",'">\n          <div class="row-info">').concat(t||"","\n          ").concat(o,'\n          </div>\n          <div class="row-data">').concat(e,"</div>\n          </div>")}function ce(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ae(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function le(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}function se(t,e){var r=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}(t,e,"get");return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,r)}var fe=new WeakMap,pe=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),le(this,fe,{writable:!0,value:"selected"}),this.group=[],this.$table=t,this.current}var r,n,o;return r=e,n=[{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.clearSelect(),this.group.push(e),this.current=e,this.current.focus(),t.G.addClass(e,se(this,fe))}},{key:"selectGroup",value:function(e){var r=this;this.clearSelect(),this.group=this.getCells(e),this.group.forEach((function(e){return t.G.addClass(e,se(r,fe))}))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.dataset.id}))}},{key:"clearSelect",value:function(){var e=this;this.group.forEach((function(r){return t.G.removeClass(r,se(e,fe))})),this.group=[]}},{key:"getCells",value:function(e){var r=this,n=t.G.getCellId(this.current),o=t.G.getCellId(e),i=Jt(n.col,o.col);return Jt(n.row,o.row).reduce((function(t,e){return i.forEach((function(r){return t.push("".concat(e,":").concat(r))})),t}),[]).map((function(t){return r.$table.querySelector('[data-id="'.concat(t,'"]'))}))}},{key:"applyStyle",value:function(t){var e=ce(Object.entries(t)[0],2),r=e[0],n=e[1];this.group.forEach((function(t){t.style[r]="".concat(n)}))}}],n&&ue(r.prototype,n),o&&ue(r,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function he(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */he=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof f?e:f,i=Object.create(o.prototype),c=new _(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return S()}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var a=w(c,r);if(a){if(a===s)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,c),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var s={};function f(){}function p(){}function y(){}var h={};a(h,o,(function(){return this}));var b=Object.getPrototypeOf,v=b&&b(b(P([])));v&&v!==e&&r.call(v,o)&&(h=v);var d=y.prototype=f.prototype=Object.create(h);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function g(t,e){function n(o,i,c,a){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==ye(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,a)}),(function(t){n("throw",t,c,a)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,a)}))}a(u.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,s;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=y,a(d,"constructor",y),a(y,"constructor",p),p.displayName=a(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,a(t,c,"GeneratorFunction")),t.prototype=Object.create(d),t},t.awrap=function(t){return{__await:t}},m(g.prototype),a(g.prototype,i,(function(){return this})),t.AsyncIterator=g,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var c=new g(u(e,r,n,o),i);return t.isGeneratorFunction(r)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},m(d),a(d,c,"Generator"),a(d,o,(function(){return this})),a(d,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return c.type="throw",c.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},t}function be(t,e,r,n,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,o)}function ve(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function de(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function me(){return me="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ge(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},me.apply(this,arguments)}function ge(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pe(t)););return t}function we(t,e){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},we(t,e)}function Oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Pe(t);if(e){var o=Pe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return je(this,r)}}function je(t,e){if(e&&("object"===ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _e(t)}function _e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(t){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pe(t)}function Se(t,e,r){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,r)}function Ee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ke(t,e){var r=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}(t,e,"get");return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,r)}var xe=new WeakMap,Te=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&we(t,e)}(u,e);var r,n,o,i,c,a=Oe(u);function u(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),r=a.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(r),!0).forEach((function(e){Ee(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Table",listeners:["mousedown","keydown","input"]},e)),Se(_e(r),xe,{writable:!0,value:34}),r}return r=u,n=[{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e=arguments.length>1?arguments[1]:void 0,r=Qt-Zt+1,n=[],o=new Array(r).fill("").map(re).map(ee(e)).map(oe).join("");n.push(ie(null,o));for(var i=0;i<t;i++){var c=new Array(r).fill("").map(ne(i,e)).join("");n.push(ie(i+1,c,e))}return n.join("")}(ke(this,xe),this.store.getState())}},{key:"prepare",value:function(){this.selection=new pe(this.$root),this.subscribeEvents()}},{key:"init",value:function(){me(Pe(u.prototype),"init",this).call(this);var t=this.$root.querySelector("[data-id='0:0']");this.selection.select(t),this.updateCurrentStyle(t),this.giveCellText(t,"table:select")}},{key:"subscribeEvents",value:function(){var e=this;this.subscribeOnEvent("formula:input",(function(r){t.G.attr(e.selection.current,"data-value",r);var n=t.G.parseCell(r);t.G.changeText(e.selection.current,n),e.updateStoreText(r)})),this.subscribeOnEvent("formula:done",(function(){return e.selection.select()})),this.subscribeOnEvent("toolbar:applyStyle",(function(t){var r;e.selection.applyStyle(t),e.dispatch((r={value:t,ids:e.selection.selectedIds},{type:tt,data:r}))}))}},{key:"updateCurrentStyle",value:function(e){var r=t.G.getStyles(Object.keys(X),e);this.dispatch({type:et,data:r})}},{key:"giveCellText",value:function(t,e){var r=t.dataset.value;this.emitEvent(e,r)}},{key:"resizeTable",value:(i=he().mark((function t(e){var r;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Yt(this.$root,e);case 3:r=t.sent,this.dispatch(nt(r)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})),c=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=i.apply(t,e);function c(t){be(o,r,n,c,a,"next",t)}function a(t){be(o,r,n,c,a,"throw",t)}c(void 0)}))},function(t){return c.apply(this,arguments)})},{key:"onMousedown",value:function(t){var e=t.target;e.dataset.resize?(t.preventDefault(),this.resizeTable(e)):function(t){return t.dataset.id}(e)&&(t.shiftKey?this.selection.selectGroup(e):(this.selection.select(e),this.giveCellText(this.selection.current,"table:select"),this.updateCurrentStyle(e)))}},{key:"onKeydown",value:function(e){var r=e.key;if(["Enter","Tab","ArrowLeft","ArrowRight","ArrowDown","ArrowUp"].includes(r)&&!e.shiftKey){e.preventDefault();var n=t.G.getCellId(this.selection.current),o=this.$root.querySelector(function(t,e,r){var n=e.row,o=e.col;switch(t){case"Enter":case"ArrowDown":++n>r&&(n=r);break;case"Tab":case"ArrowRight":++o>25&&(o=25);break;case"ArrowLeft":--o<0&&(o=0);break;case"ArrowUp":--n<0&&(n=0)}return'[data-id="'.concat(n,":").concat(o,'"]')}(r,n,ke(this,xe)-1));this.selection.select(o),this.giveCellText(o,"table:select")}}},{key:"updateStoreText",value:function(t){var e;this.dispatch((e={id:this.selection.current.dataset.id,value:t},{type:V,data:e}))}},{key:"onInput",value:function(e){var r=e.target;this.updateStoreText(t.G.getText(r))}}],n&&de(r.prototype,n),o&&de(r,o),Object.defineProperty(r,"prototype",{writable:!1}),u}(K);function Re(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ce(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(r),!0).forEach((function(e){De(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function De(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Le(t,e){var r,n;switch(e.type){case Q:return n="col"===e.data.type?"colState":"rowState",Ce(Ce({},t),{},De({},n,Ae(t,n,e)));case V:return n="dataState",Ce(Ce({},t),{},De({currentText:e.data.value},n,Ae(t,n,e)));case et:return Ce(Ce({},t),{},{currentStyles:e.data});case tt:var o=t[n="stylesState"]||{};return e.data.ids.forEach((function(t){o[t]=Ce(Ce({},o[t]),e.data.value)})),Ce(Ce({},t),{},(De(r={},n,o),De(r,"currentStyles",Ce(Ce({},t.currentStyles),e.data.value)),r));case rt:return Ce(Ce({},t),{},{title:e.data});default:return t}}function Ae(t,e,r){var n=t[e]||{};return n[r.data.id]=r.data.value,n}function Ge(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function He(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ge(Object(r),!0).forEach((function(e){Ie(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Ee(Te,"className","excel__table");var Ne={rowState:{},colState:{},dataState:{},currentText:"",currentStyles:X,stylesState:{},title:Z};function Me(t){return t?function(t){return He(He({},t),{},{currentStyles:X,currentText:""})}(t):(e=Ne,JSON.parse(JSON.stringify(e)));var e}function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function qe(t,e){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qe(t,e)}function We(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Fe(t);if(e){var o=Fe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Je(this,r)}}function Je(t,e){if(e&&("object"===$e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Fe(t){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(t)}var Ye=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qe(t,e)}(c,t);var e,n,o,i=We(c);function c(){return ze(this,c),i.apply(this,arguments)}return e=c,n=[{key:"getRoot",value:function(){this.params||(this.params=Date.now().toString(),r.navigate("#excel/".concat(this.params)));var t="excel:"+this.params,e=function(t,e){return new T(t,e)}(Le,Me(u(t))),n=s((function(e){u(t,e)}),200);return e.subscribe(n),this.excel=new G({components:[ht,Gt,Wt,Te],store:e}),this.excel.getRoot()}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy()}}],n&&Be(e.prototype,n),o&&Be(e,o),Object.defineProperty(e,"prototype",{writable:!1}),c}(c);new o("#app",{dashboard:_,excel:Ye})}()})();